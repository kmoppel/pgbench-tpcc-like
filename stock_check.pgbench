SELECT w_id FROM ( SELECT w_id FROM warehouse ORDER BY w_id DESC LIMIT (select ceil(count(*)*0.2) from warehouse) ) x ORDER BY random() LIMIT 1 \gset

\set d_id random(1, 10)

-- 2.8.1.2 The threshold of minimum quantity in stock (threshold ) is selected at random within [10 .. 20].
\set threshold random(10, 20)

SELECT * FROM tpcc_utils.get_low_stock_items(:w_id, :d_id, :threshold);
